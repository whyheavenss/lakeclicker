<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lake</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  <style>
    :root {
      --primary-blue: rgb(48, 204, 0);
      --primary-blue-light: #4DA2FF;
      --secondary-blue: #0051D5;
      --primary-purple: #5856D6;
      --accent-orange: #FF9500;
      --accent-red: #FF3B30;
      
      --bg-primary: #000000f1;
      --bg-secondary: #1C1C1E;
      --bg-tertiary: #2C2C2E;
      --bg-quaternary: #3A3A3C;
      
      --text-primary: #FFFFFF;
      --text-secondary: #99999C;
      --text-tertiary: #6D6D70;

      
      --separator: #38383A;
      --overlay: rgba(0, 0, 0, 0.4);
      
      --shadow-small: 0 1px 3px rgba(0, 0, 0, 0.3);
      --shadow-medium: 0 4px 12px rgba(0, 0, 0, 0.5);
              --shadow-large: 0 8px 32px rgba(0, 0, 0, 0.7);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }


    
    body {
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
      line-height: 1.5;
    }

         .app-container {
       max-width: 430px;
      margin: 0 auto;
       background: var(--bg-primary);
       min-height: 100vh;
      position: relative;
       overflow-x: hidden;
    }

    /* Header */
    .app-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 60px 20px 20px;
      background: var(--bg-primary);
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

         .user-avatar {
       width: 32px;
       height: 32px;
       background: var(--bg-secondary);
       border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
       font-size: 16px;
       font-weight: 600;
    }

    .balance-info {
      display: flex;
      flex-direction: column;
    }

    .balance-label {
      font-size: 12px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .balance-amount {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .balance-currency {
      font-size: 18px;
      font-weight: 600;
      color: var(--primary-blue);
      margin-left: 4px;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

         .add-button {
       width: 36px;
       height: 36px;
       background: var(--bg-secondary);
       border: none;
       border-radius: 10px;
       color: var(--primary-blue);
      display: flex;
      align-items: center;
      justify-content: center;
       font-size: 18px;
       cursor: pointer;
       transition: all 0.2s ease;
     }

    .add-button:hover {
      background: var(--bg-tertiary);
      transform: scale(1.05);
    }

    /* Featured Section */
    .featured-section {
      padding: 0 20px 24px;
    }

         .featured-card {
       background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-blue-light) 100%);
      border-radius: 20px;
      padding: 24px;
       position: relative;
       overflow: hidden;
       cursor: pointer;
       transition: transform 0.3s ease;
       box-shadow: var(--shadow-large);
     }

    .featured-card:hover {
      transform: translateY(-4px);
    }

    .featured-content {
      position: relative;
      z-index: 2;
    }

    .featured-badge {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border-radius: 8px;
      padding: 6px 12px;
      font-size: 12px;
      font-weight: 600;
      color: white;
      display: inline-block;
      margin-bottom: 12px;
    }

    .featured-title {
      font-size: 24px;
      font-weight: 800;
      color: white;
      margin-bottom: 8px;
    }

    .featured-subtitle {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 20px;
    }

    .featured-button {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      padding: 12px 20px;
      color: white;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .featured-button:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: translateY(-1px);
    }

    .featured-decoration {
      position: absolute;
      top: 0;
      right: 0;
      width: 120px;
      height: 120px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      transform: translate(40px, -40px);
    }

    /* Categories */
    .categories-section {
      padding: 0 20px 24px;
    }

    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .section-title {
      font-size: 22px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .section-subtitle {
      font-size: 14px;
      color: var(--text-secondary);
    }

    .categories-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .category-card {
      background: var(--bg-secondary);
      border-radius: 16px;
      padding: 50px 16px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      position: fixed;
      left: 800px;
      width: 300px;
      height: 260px;
      overflow: hidden;
      border: 1px solid var(--separator);
    }

    .category-card:hover {
      background: var(--bg-tertiary);
      transform: translateY(-2px);
      box-shadow: var(--shadow-medium);
    }



    .category-icon {
      width: 50px;
      height: 120px;
      background: var(--bg-tertiary);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 12px;
      border: 1px solid var(--separator);
    }

    .category-icon img {
      width: 1000px;
      height: 200px;
      border-radius: 8px;
      object-fit: cover;
    }

    .category-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-secondary);
      margin: 15%;
    }

    .category-price {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      background: var(--bg-tertiary);
      border-radius: 8px;
      padding: 6px 12px;
      font-size: 14px;
      font-weight: 700;
      color: var(--primary-blue);
    }

    .price-icon {
      font-size: 14px;
      color: var(--primary-blue);
      margin-left: 4px;
    }

    /* Bottom Navigation */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      max-width: 430px;
      background: var(--bg-secondary);
      backdrop-filter: blur(20px);
      border-top: 1px solid var(--separator);
      padding: 8px 0 32px;
      z-index: 1000;
    }

    .nav-container {
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 0 20px;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-decoration: none;
      color: var(--text-secondary);
      transition: all 0.2s ease;
      padding: 8px 12px;
      border-radius: 12px;
      min-width: 60px;
    }

    .nav-item.active {
       color: var(--primary-blue);
       background: rgba(0, 122, 255, 0.1);
    }

    .nav-item:hover {
       color: var(--primary-blue);
       background: rgba(0, 122, 255, 0.05);
    }

    .nav-icon {
      font-size: 20px;
      margin-bottom: 4px;
    }

    .nav-label {
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }


    .prize-display {
      margin: 20px;
      padding: 20px;
      background: var(--bg-secondary);
      border-radius: 16px;
      text-align: center;
      border: 1px solid var(--separator);
        opacity: 0;
      transform: translateY(20px);
      transition: all 0.5s ease;
      }

    .prize-display.show {
        opacity: 1;
        transform: translateY(0);
    }

    .prize-emoji {
      font-size: 48px;
      margin-bottom: 16px;
    }

    .prize-title {
      font-size: 16px;
      font-weight: 600;
      color: var(---text-secondary);
      margin-bottom: 4px;
    }

    .prize-description {
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.4;
    }

    /* Responsive adjustments */
    @media (max-width: 380px) {
      .app-header {
        padding: 50px 16px 16px;
      }
      
      .featured-section,
      .categories-section {
        padding-left: 16px;
        padding-right: 16px;
      }
      
      .featured-title {
        font-size: 20px;
      }
      
      .section-title {
        font-size: 20px;
      }
      
      .category-icon {
        width: 56px;
        height: 56px;
    }

             .category-icon img {
         width: 40px;
         height: 40px;
       }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-in-up {
      animation: fadeInUp 0.6s ease-out;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .spinning {
      animation: spin 0.1s linear infinite;
      }
      
    .loading {
      pointer-events: none;
      opacity: 0.6;
      }
      
    .loading::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 20px;
      border: 2px solid var(--text-secondary);
      border-top: 2px solid var(--primary-blue);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      transform: translate(-50%, -50%);
    }
    
    /* Prize reel animations */
    .prize-reel-container {
      position: relative;
      overflow: hidden;
      border-radius: 12px;
      background: var(--bg-tertiary);
      border: 1px solid var(--separator);
      }
      
    .prize-reel {
      display: flex;
      align-items: center;
      height: 100%;
      will-change: transform;
      backface-visibility: hidden;
      transform-style: preserve-3d;
    }
    
    .prize-item {
      flex-shrink: 0;
      will-change: transform;
      backface-visibility: hidden;
      }
      
    * {
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
  </style>
</head>
<body>
  <div class="app-container">
    <header class="app-header fade-in-up">
             <div class="header-left">
         <div class="user-avatar"><i class="bi bi-coin"></i></div>
         <div class="balance-info">

           <div class="balance-amount">
             <span id="userBalance">0</span>
             <span class="balance-currency">Lake</span>
           </div>
         </div>
       </div>
      <div class="header-actions">


        </button>
      </div>
    </header>

    <section class="featured-section fade-in-up">
             <div class="featured-card" href="t.me/LakeCase">
      <div class="featured-content">
           <div class="featured-title">–ó–∞—Ö–æ–¥–∏ –≤ –Ω–∞—à –∫–∞–Ω–∞–ª!</div>

        <button class="featured-button" id="freeCaseButton">
          <i class="fas fa-gift"></i> –ó–∞–π—Ç–∏
        </button>
      </div>
         <div class="featured-decoration"></div>
      </div>
    </section>

                 <div class="category-card" onclick="addBalanceAnimated(this)">
           <div class="category-icon">
             <img src="pic/gargonna.gif" alt="Gargonna">
           </div>
           <div class="category-title">Tap tap tap...</div>
        </div>
      </div>

    <section class="categories-section fade-in-up">
      <div class="section-header">
        <div>

        </div>
        </div>


        </div>
      </div>
    </div>
    </section>

    <div class="prize-display" id="prizeCard">
      <div class="prize-emoji" id="prizeEmoji">üéâ</div>
      <div class="prize-title" id="prizeTitle">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</div>
      <div class="prize-description" id="prizeDescription">–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç!</div>
    </div>

     <div style="height: 90px;"></div>
  </div>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav">
         <div class="nav-container">
       <a href="#" class="nav-item active" data-tab="store" onclick="showStore()">
         <i class="nav-icon fas fa-home"></i>
         <span class="prize-title">Farm</span>
      </a>
       <a href="" class="nav-item" data-tab="gifts">
         <i class="nav-icon fas fa-gift"></i>
         <span class="prize-title">Shop</span>
      </a>
              <a href="" class="nav-item" data-tab="profile">
        <i class="nav-icon fas fa-user"></i>
        <span class="prize-title">Profile</span>
      </a>
    </div>
  </nav>

  <script>
    if (window.Telegram?.WebApp) {
      window.Telegram.WebApp.ready();
      window.Telegram.WebApp.expand();
    }

    let gameState = {
      spins: parseInt(localStorage.getItem('totalSpins') || '0'),
      wins: parseInt(localStorage.getItem('totalWins') || '0'),
      balance: 0,
      lastFreeCaseTime: parseInt(localStorage.getItem('lastFreeCaseTime') || '0'),
      cooldownTime: 24 * 60 * 60 * 1000,
      isOpening: false
    };

    const freeCaseButton = document.getElementById('freeCaseButton');
    const userBalanceEl = document.getElementById('userBalance');

    function init() {
       const saved = localStorage.getItem("lake_balance");
  gameState.balance = saved ? parseInt(saved) : 0;
      updateStats();
      updateFreeCaseButton();
      setInterval(updateFreeCaseButton, 1000);
    }

    function updateStats() {
      userBalanceEl.textContent = gameState.balance.toString();
    }
function addBalanceAnimated(cardElement) {
  // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –±–∞–ª–∞–Ω—Å
  gameState.balance += 1;
  userBalanceEl.textContent = gameState.balance;
  localStorage.setItem("lake_balance", gameState.balance);


  // –ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª—å—Å–∞ –¥–ª—è –±–∞–ª–∞–Ω—Å–∞
  userBalanceEl.animate([
    { transform: 'scale(1)' },
    { transform: 'scale(1.25)' },
    { transform: 'scale(1)' }
  ], {
    duration: 300,
    easing: 'ease'
  });

  // –ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª—å—Å–∞ –¥–ª—è –∫–µ–π—Å–∞ (—ç–ª–µ–º–µ–Ω—Ç–∞)
  cardElement.animate([
    { transform: 'scale(1)' },
    { transform: 'scale(1.1)' },
    { transform: 'scale(1)' }
  ], {
    duration: 200,
    easing: 'ease'
  });
}


  

    function updateFreeCaseButton() {
      const now = Date.now();
      const timeSinceLastCase = now - gameState.lastFreeCaseTime;
      const timeRemaining = Math.max(0, gameState.cooldownTime - timeSinceLastCase);

 
        freeCaseButton.disabled = false;
        freeCaseButton.innerHTML = '<i class="fas fa-gift"></i> –û—Ç–∫—Ä—ã—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ';
      }


    function checkFreeCaseAvailability() {
      const now = Date.now();
      const timeSinceLastCase = now - gameState.lastFreeCaseTime;
      return timeSinceLastCase >= gameState.cooldownTime;
    }

    function openFreeCase() {
      if (gameState.isOpening || !checkFreeCaseAvailability()) return;
      showFreeCaseModal();
    }

     function showFreeCaseModal() {
       const modal = document.createElement('div');
       
       setTimeout(() => {
         initializePrizeReel();
       }, 100);

      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        animation: fadeIn 0.3s ease-out;
        padding: 20px;
      `;
      
      modal.innerHTML = `
        <div style="
          background: var(--bg-secondary);
          border-radius: 20px;
          padding: 30px;
          text-align: center;
          max-width: 380px;
          width: 100%;
          border: 1px solid var(--separator);
          box-shadow: var(--shadow-large);
          position: relative;
        ">
          <button onclick="this.closest('.modal').remove()" style="
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 20px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s ease;
          " onmouseover="this.style.background='var(--bg-tertiary)'" onmouseout="this.style.background='none'">
            ‚úï
          </button>
          
          <h2 style="color: var(--text-primary); margin-bottom: 20px; font-size: 1.5rem; font-weight: 700;">Free case</h2>
          
                     <div style="
             position: relative;
             width: 100%;
             height: 120px;
             overflow: hidden;
             border-radius: 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--separator);
             margin: 30px 0;
           ">
             <div style="
               position: absolute;
               top: 10px;
               left: 50%;
               transform: translateX(-50%);
               width: 0;
               height: 0;
               border-left: 12px solid transparent;
               border-right: 12px solid transparent;
               border-top: 15px solid var(--primary-blue);
               z-index: 100;
             "></div>
            
              <div id="prizeReel" style="
                display: flex;
                align-items: center;
                height: 100%;
              transition: transform 0.1s ease-out;
              padding: 20px;
            ">
              <!-- Prize items will be generated here -->
            </div>
           </div>
          
                     <button onclick="spinFreeCase()" style="
             background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-light));
             border: none;
             padding: 15px 30px;
             border-radius: 12px;
             color: white;
             font-weight: 600;
             cursor: pointer;
             width: 100%;
             font-size: 16px;
             transition: transform 0.2s ease;
             box-shadow: var(--shadow-medium);
           " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
             –ö—Ä—É—Ç–∏—Ç—å
           </button>
        </div>
      `;
      
      modal.className = 'modal';
      document.body.appendChild(modal);
    }

     function initializePrizeReel() {
       const reel = document.getElementById('prizeReel');
       if (!reel) return;
       
       reel.innerHTML = '';
       
       const totalItems = prizes.length * 8;
       
       for (let i = 0; i < totalItems; i++) {
         const prizeIndex = i % prizes.length;
         const prize = prizes[prizeIndex];
         
         const prizeItem = document.createElement('div');
         prizeItem.className = 'prize-item';
         prizeItem.style.cssText = `
           flex-shrink: 0;
           width: 80px;
           height: 80px;
           background: var(--bg-tertiary);
           border: 1px solid var(--separator);
           border-radius: 12px;
           display: flex;
           align-items: center;
           justify-content: center;
           margin-right: 20px;
           position: relative;
           transition: transform 0.2s ease;
         `;
         
         const img = document.createElement('img');
         img.src = prize.gif;
         img.alt = prize.title;
         img.style.cssText = `
           width: 60px; 
           height: 60px; 
           border-radius: 8px; 
           object-fit: cover;
           user-select: none;
           pointer-events: none;
         `;
         
         img.onerror = function() {
           this.style.display = 'none';
           const fallback = document.createElement('div');
           fallback.style.cssText = `
             width: 60px;
             height: 60px;
             background: var(--primary-blue);
             border-radius: 8px;
             display: flex;
             align-items: center;
             justify-content: center;
             color: white;
             font-size: 24px;
           `;
           fallback.textContent = 'üéÅ';
           prizeItem.appendChild(fallback);
         };
         
         prizeItem.appendChild(img);
         reel.appendChild(prizeItem);
       }
       
       reel.style.transition = 'none';
       reel.style.transform = 'translateX(0px)';
       reel.style.display = 'flex';
       reel.style.alignItems = 'center';
       reel.style.height = '100%';
       
       reel.offsetHeight;
     }

     function spinFreeCase() {
       if (gameState.isOpening) return;

       gameState.isOpening = true;
       gameState.lastFreeCaseTime = Date.now();
       localStorage.setItem('lastFreeCaseTime', gameState.lastFreeCaseTime.toString());
       
       const spinButton = document.querySelector('button[onclick="spinFreeCase()"]');
       if (spinButton) {
         spinButton.disabled = true;
         spinButton.style.opacity = '0.6';
         spinButton.style.cursor = 'not-allowed';
         spinButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –ö—Ä—É—Ç–∏–º...';
       }

       animateSpinReel((winningPrizeIndex) => {
         setTimeout(() => {
           const modal = document.querySelector('.modal');
           if (modal) {
             modal.remove();
           }
           
         setTimeout(() => {
           showPrizeClaimWindow(winningPrizeIndex);
             gameState.isOpening = false;
           }, 300);
         }, 500);
       });
     }

     function animateSpinReel(callback) {
       const reel = document.getElementById('prizeReel');
       if (!reel) return;

       const freeCasePrizes = [0, 1, 2, 3, 4, 5, 13, 14];
       const winningPrizeIndex = freeCasePrizes[Math.floor(Math.random() * freeCasePrizes.length)];
       
       const ITEM_WIDTH = 100;
       const CONTAINER_WIDTH = 380;
       const CENTER_OFFSET = CONTAINER_WIDTH / 2 - 40;
       
       reel.style.transition = 'none';
       reel.style.transform = 'translateX(0px)';
       
       const targetPosition = winningPrizeIndex * ITEM_WIDTH;
       const finalPosition = CENTER_OFFSET - targetPosition;
       
       const extraSpins = 5; 
       const totalPrizes = prizes.length;
       const fullSpinDistance = totalPrizes * ITEM_WIDTH;
       const totalDistance = Math.abs(finalPosition) + (extraSpins * fullSpinDistance);
       
       let currentPosition = 0;
       let velocity = 0;
       const maxVelocity = 120;
       const acceleration = 8;
       const deceleration = 0.98;
       
       let phase = 'accelerating';
       let animationId;
       const startTime = Date.now();
       const totalDuration = 4000;
       
       function animate() {
         const elapsed = Date.now() - startTime;
         const progress = Math.min(elapsed / totalDuration, 1);
         
         if (progress < 1) {
           if (progress < 0.2) {
             velocity = Math.min(velocity + acceleration, maxVelocity);
             phase = 'accelerating';
           } else if (progress < 0.7) {
             velocity = maxVelocity;
             phase = 'cruising';
           } else {
             const decelerationProgress = (progress - 0.7) / 0.3;
             const easedProgress = 1 - Math.pow(1 - decelerationProgress, 3);
             velocity = maxVelocity * (1 - easedProgress);
             phase = 'decelerating';
           }
           
           currentPosition -= velocity;
           reel.style.transform = `translateX(${currentPosition}px)`;
           
           animationId = requestAnimationFrame(animate);
         } else {
           cancelAnimationFrame(animationId);

           reel.style.transition = 'transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
           reel.style.transform = `translateX(${finalPosition}px)`;

           setTimeout(() => {
             reel.style.transition = 'none';
           reel.style.transform = `translateX(${finalPosition}px)`;

           setTimeout(() => {
             callback(winningPrizeIndex);
             }, 200);
           }, 800);
         }
       }
       
       // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
       requestAnimationFrame(animate);
     }

     function showPrizeClaimWindow(prizeIndex) {
       const prize = prizes[prizeIndex];
       
       const modal = document.createElement('div');
       modal.style.cssText = `
         position: fixed;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         background: rgba(0, 0, 0, 0.95);
         display: flex;
         align-items: center;
         justify-content: center;
         z-index: 10000;
         animation: fadeIn 0.3s ease-out;
         padding: 20px;
       `;
       
       modal.innerHTML = `
         <div style="
          background: var(--bg-secondary);
           border-radius: 20px;
           padding: 40px 30px;
           text-align: center;
           max-width: 350px;
           width: 100%;
          border: 1px solid var(--separator);
          box-shadow: var(--shadow-large);
         ">
           <div style="font-size: 3rem; margin-bottom: 20px;">üéâ</div>
           
          <h2 style="color: var(--text-primary); margin-bottom: 15px; font-size: 1.4rem; font-weight: 700;">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
           
           <div style="
             width: 120px;
             height: 120px;
             background: var(--bg-tertiary);
             border: 2px solid var(--primary-blue);
             border-radius: 16px;
             display: flex;
             align-items: center;
             justify-content: center;
             margin: 20px auto 30px;
           ">
                         <img src="${prize.gif}" alt="Prize" style="width: 100px; height: 100px; border-radius: 12px; object-fit: cover;">
           </div>
           
           
           
           <button onclick="claimPrize(${prizeIndex})" style="
             background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-light));
             border: none;
             padding: 15px 30px;
             border-radius: 12px;
             color: white;
             font-weight: 600;
             cursor: pointer;
             width: 100%;
             font-size: 16px;
             transition: transform 0.2s ease;
             box-shadow: var(--shadow-medium);
           " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
             –ó–∞–±—Ä–∞—Ç—å –ø—Ä–∏–∑
           </button>
         </div>
       `;
       
       modal.className = 'modal';
       document.body.appendChild(modal);
     }

     function claimPrize(prizeIndex) {
       const prize = prizes[prizeIndex];
       
       const currentModal = document.querySelector('.modal');
       if (currentModal) {
         currentModal.remove();
       }
       
       const modal = document.createElement('div');
       modal.style.cssText = `
         position: fixed;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         background: rgba(0, 0, 0, 0.95);
         display: flex;
         align-items: center;
         justify-content: center;
         z-index: 10000;
         animation: fadeIn 0.3s ease-out;
         padding: 20px;
       `;
       
       modal.innerHTML = `
         <div style="
          background: var(--bg-secondary);
           border-radius: 20px;
           padding: 30px;
           text-align: center;
           max-width: 380px;
           width: 100%;
          border: 1px solid var(--separator);
          box-shadow: var(--shadow-large);
         ">
           <div style="font-size: 2.5rem; margin-bottom: 20px;">ü§ñ</div>
           
          <h2 style="color: var(--text-primary); margin-bottom: 15px; font-size: 1.3rem; font-weight: 700;">–ü–æ–ª—É—á–∏—Ç–µ —Å–≤–æ–π –ø—Ä–∏–∑!</h2>
           <p style="color: var(--text-secondary); margin-bottom: 30px; line-height: 1.4; font-size: 14px;">
             –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –¢–µ–ª–µ–≥—Ä–∞–º –¥–ª—è –±–∏–∑–Ω–µ—Å–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç –±–æ—Ç—ã, –≤ –ø–æ–ª–µ –≤–≤–µ–¥–∏—Ç–µ —é–∑–µ—Ä–Ω–µ–π–º –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞ (@LuckyNFTRobot), –¥–∞–ª–µ–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≥–∞–ª–æ—á–∫—É –Ω–∞ –ø—É–Ω–∫—Ç–µ –ø–æ–¥–∞—Ä–∫–∏ –∏ –∑–≤–µ–∑–¥—ã, –∑–∞—Ç–µ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ.
           </p>
           
           <button onclick="showInstructionPrompt()" style="
             background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-light));
             border: none;
             padding: 15px 30px;
             border-radius: 12px;
             color: white;
             font-weight: 600;
             cursor: pointer;
             width: 100%;
             font-size: 16px;
             margin-bottom: 15px;
             transition: transform 0.2s ease;
             box-shadow: var(--shadow-medium);
           " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
             –°–Ω–∞—á–∞–ª–∞ –∏–∑—É—á–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
           </button>
           
           <button onclick="openInstructions()" style="
            background: var(--bg-tertiary);
            border: 1px solid var(--separator);
             padding: 15px 30px;
             border-radius: 12px;
             color: var(--text-primary);
             font-weight: 600;
             cursor: pointer;
             width: 100%;
             font-size: 16px;
             transition: transform 0.2s ease;
           " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
             –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
           </button>
         </div>
       `;
       
       modal.className = 'modal';
       document.body.appendChild(modal);
          }

     function getPrize() {
       if (window.Telegram?.WebApp) {
         window.Telegram.WebApp.openTelegramLink('tg://settings');
       } else {
         window.open('tg://settings', '_blank');
       }

       const modal = document.querySelector('.modal');
       if (modal) {
         modal.remove();
       }
       
       resetGameState();
     }

     function resetGameState() {
       gameState.isOpening = false;
       
       updateFreeCaseButton();

        updateStats();
    }

     function showInstructionPrompt() {
       const modal = document.querySelector('.modal');
       if (modal) {
         modal.remove();
       }
       
       const instructionModal = document.createElement('div');
       instructionModal.style.cssText = `
         position: fixed;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         background: rgba(0, 0, 0, 0.95);
         display: flex;
         align-items: center;
         justify-content: center;
         z-index: 10000;
         animation: fadeIn 0.3s ease-out;
         padding: 20px;
       `;
       
       instructionModal.innerHTML = `
         <div style="
           background: var(--bg-secondary);
           border-radius: 20px;
           padding: 30px;
           text-align: center;
           max-width: 380px;
           width: 100%;
           border: 1px solid var(--separator);
           box-shadow: var(--shadow-large);
         ">
           <div style="font-size: 2.5rem; margin-bottom: 20px;">üìã</div>
           
           <h2 style="color: var(--text-primary); margin-bottom: 15px; font-size: 1.3rem; font-weight: 700;">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏–∑—É—á–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é!</h2>
           <p style="color: var(--text-secondary); margin-bottom: 30px; line-height: 1.4; font-size: 14px;">
             –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∏–∑–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π. –ë–µ–∑ —ç—Ç–æ–≥–æ –ø—Ä–∏–∑ –ø–æ–ª—É—á–∏—Ç—å –Ω–µ —É–¥–∞—Å—Ç—Å—è.
           </p>
           
           <button onclick="openInstructions()" style="
             background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-light));
             border: none;
             padding: 15px 30px;
             border-radius: 12px;
        color: white;
             font-weight: 600;
             cursor: pointer;
             width: 100%;
             font-size: 16px;
             margin-bottom: 15px;
             transition: transform 0.2s ease;
             box-shadow: var(--shadow-medium);
           " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
             –ß–∏—Ç–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
           </button>
           
           <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="
             background: var(--bg-tertiary);
             border: 1px solid var(--separator);
             padding: 15px 30px;
        border-radius: 12px;
             color: var(--text-primary);
        font-weight: 600;
             cursor: pointer;
             width: 100%;
             font-size: 16px;
             transition: transform 0.2s ease;
           " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
             –ü–æ–∑–∂–µ
           </button>
         </div>
       `;
       
       instructionModal.className = 'modal';
       document.body.appendChild(instructionModal);
     }

     function openInstructions() {
       const modal = document.querySelector('.modal');
       if (modal) {
         modal.remove();
       }
       
       const instructionModal = document.createElement('div');
       instructionModal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
         background: rgba(0, 0, 0, 0.95);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        animation: fadeIn 0.3s ease-out;
         padding: 20px;
      `;
      
       instructionModal.innerHTML = `
         <div style="
           background: var(--bg-secondary);
        border-radius: 20px;
           padding: 30px;
           text-align: left;
           max-width: 400px;
           width: 100%;
           border: 1px solid var(--separator);
           box-shadow: var(--shadow-large);
           max-height: 80vh;
           overflow-y: auto;
         ">
           <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="
             position: absolute;
             top: 15px;
             right: 15px;
             background: none;
             border: none;
             color: var(--text-secondary);
             font-size: 20px;
             cursor: pointer;
             width: 30px;
             height: 30px;
             display: flex;
             align-items: center;
             justify-content: center;
             border-radius: 50%;
             transition: background 0.2s ease;
           " onmouseover="this.style.background='var(--bg-tertiary)'" onmouseout="this.style.background='none'">
             ‚úï
           </button>
           
           <div style="text-align: center; margin-bottom: 25px;">
             <div style="font-size: 2.5rem; margin-bottom: 15px;">üéÅ</div>
             <h2 style="color: var(--text-primary); margin-bottom: 10px; font-size: 1.4rem; font-weight: 700;">–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–∑</h2>
           </div>
           
           <div style="color: var(--text-secondary); line-height: 1.6; font-size: 14px;">
             <div style="margin-bottom: 20px;">
               <h3 style="color: var(--text-primary); font-size: 16px; margin-bottom: 10px;">üì± –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram</h3>
               <p>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–∑" –Ω–∏–∂–µ, —á—Ç–æ–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–π—Ç–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram.</p>
             </div>
             
             <div style="margin-bottom: 20px;">
               <h3 style="color: var(--text-primary); font-size: 16px; margin-bottom: 10px;">‚öôÔ∏è –®–∞–≥ 2: –ù–∞–π–¥–∏—Ç–µ "Telegram –¥–ª—è –±–∏–∑–Ω–µ—Å–∞"</h3>
               <p>–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –Ω–∞–π–¥–∏—Ç–µ –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –ø—É–Ω–∫—Ç "Telegram –¥–ª—è –±–∏–∑–Ω–µ—Å–∞".</p>
             </div>
             
             <div style="margin-bottom: 20px;">
               <h3 style="color: var(--text-primary); font-size: 16px; margin-bottom: 10px;">ü§ñ –®–∞–≥ 3: –í—ã–±–µ—Ä–∏—Ç–µ "–ß–∞—Ç-–±–æ—Ç—ã"</h3>
               <p>–í —Ä–∞–∑–¥–µ–ª–µ "Telegram –¥–ª—è –±–∏–∑–Ω–µ—Å–∞" –≤—ã–±–µ—Ä–∏—Ç–µ "–ß–∞—Ç-–±–æ—Ç—ã".</p>
             </div>
             
             <div style="margin-bottom: 20px;">
               <h3 style="color: var(--text-primary); font-size: 16px; margin-bottom: 10px;">üîó –®–∞–≥ 4: –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞</h3>
               <p>–í –ø–æ–ª–µ –≤–≤–µ–¥–∏—Ç–µ —é–∑–µ—Ä–Ω–µ–π–º –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞: <strong style="color: var(--primary-blue);">@LuckyNFTRobot</strong></p>
             </div>
             
             <div style="margin-bottom: 25px;">
               <h3 style="color: var(--text-primary); font-size: 16px; margin-bottom: 10px;">‚úÖ –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è</h3>
               <p>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≥–∞–ª–æ—á–∫—É –Ω–∞ –ø—É–Ω–∫—Ç–µ "–ü–æ–¥–∞—Ä–∫–∏ –∏ –∑–≤–µ–∑–¥—ã", –∑–∞—Ç–µ–º –Ω–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å".</p>
             </div>
           </div>
           
           <button onclick="getPrizeAfterInstructions()" style="
             background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-light));
          border: none;
             padding: 15px 30px;
          border-radius: 12px;
          color: white;
          font-weight: 600;
          cursor: pointer;
             width: 100%;
             font-size: 16px;
          transition: transform 0.2s ease;
             box-shadow: var(--shadow-medium);
        " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
             –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–∑
        </button>
         </div>
      `;
      
       instructionModal.className = 'modal';
       document.body.appendChild(instructionModal);
     }
     
     function getPrizeAfterInstructions() {
       if (window.Telegram?.WebApp) {
         window.Telegram.WebApp.openTelegramLink('tg://settings');
       } else {
         window.open('tg://settings', '_blank');
       }
       
       // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
       const modal = document.querySelector('.modal');
       if (modal) {
          modal.remove();
        }
       
       // –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
       resetGameState();
    }

    function showCaseInDevelopment() {
      showPaidCaseModal();
    }

    function showPaidCaseModal() {
      const modal = document.createElement('div');
      
      setTimeout(() => {
        initializePrizeReel();
          }, 100);
          
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        animation: fadeIn 0.3s ease-out;
        padding: 20px;
      `;
      
      modal.innerHTML = `
        <div style="
          background: var(--bg-secondary);
        border-radius: 20px;
          padding: 30px;
        text-align: center;
          max-width: 380px;
          width: 100%;
          border: 1px solid var(--separator);
          box-shadow: var(--shadow-large);
          position: relative;
        ">
        <button onclick="this.closest('.modal').remove()" style="
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
          border: none;
            color: var(--text-secondary);
            font-size: 20px;
          cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s ease;
          " onmouseover="this.style.background='var(--bg-tertiary)'" onmouseout="this.style.background='none'">
            ‚úï
        </button>
          
          <h2 style="color: var(--text-primary); margin-bottom: 20px; font-size: 1.5rem; font-weight: 700;">Case</h2>
          
          <div style="
            position: relative;
        width: 100%;
            height: 120px;
            overflow: hidden;
            border-radius: 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--separator);
            margin: 30px 0;
          ">
            <div style="
              position: absolute;
              top: 10px;
              left: 50%;
              transform: translateX(-50%);
              width: 0;
              height: 0;
              border-left: 12px solid transparent;
              border-right: 12px solid transparent;
              border-top: 15px solid var(--primary-blue);
              z-index: 100;
            "></div>
            
            <div id="prizeReel" style="
        display: flex;
        align-items: center;
              height: 100%;
              transition: transform 0.1s ease-out;
              padding: 20px;
            ">
              <!-- Prize items will be generated here -->
            </div>
          </div>
          
          <button disabled style="
            background: var(--text-secondary);
          border: none;
            padding: 15px 30px;
          border-radius: 12px;
          color: white;
          font-weight: 600;
            cursor: not-allowed;
            width: 100%;
            font-size: 16px;
            margin-bottom: 15px;
            opacity: 0.6;
          ">
            <i class="fas fa-lock" style="margin-right: 8px;"></i>
            –£ –≤–∞—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤
        </button>
          
          <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.4;">
            –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–µ–π—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∏–∑–æ–≤
          </p>
        </div>
      `;
      
      modal.className = 'modal';
      document.body.appendChild(modal);
    }



    function updateNavigation(activeTab) {
      const navItems = document.querySelectorAll('.nav-item');
      navItems.forEach(item => {
        const isActive = item.dataset.tab === activeTab;
        item.style.color = isActive ? 'var(--primary-blue)' : 'var(--text-secondary)';
        if (isActive) {
          item.classList.add('active');
        } else {
          item.classList.remove('active');
        }
      });
    }

    function showStore() {
      location.reload();
    }

    init();

    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html> 